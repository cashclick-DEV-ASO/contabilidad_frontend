var j=Object.defineProperty;var f=(e,s,t)=>s in e?j(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var n=(e,s,t)=>(f(e,typeof s!="symbol"?s+"":s,t),t),a=(e,s,t)=>{if(!s.has(e))throw TypeError("Cannot "+t)};var h=(e,s,t)=>(a(e,s,"read from private field"),t?t.call(e):s.get(e)),c=(e,s,t)=>{if(s.has(e))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(e):s.set(e,t)},l=(e,s,t,i)=>(a(e,s,"write to private field"),i?i.call(e,t):s.set(e,t),t);import{l as g,e as u,m,C as o,M as w,b as d}from"./componente-990ccac5.js";class C{constructor(s){this.apiHOST=s,this.resultado=null,this.error=null}async post(s,t){try{const i=await this.postSync(s,t);await this.procesaResultado(i)}catch(i){this.error=i,this.resultado=null}}postSync(s,t){return fetch(`${this.apiHOST}/${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}async get(s){try{const t=await this.getSync(s);await this.procesaResultado(t)}catch(t){this.error=t,this.resultado=null}}getSync(s){return fetch(`${this.apiHOST}/${s}`)}async procesaResultado(s){try{this.resultado=await this.procesaResultadoSync(s),this.error=null}catch(t){this.error=t,this.resultado=null}}procesaResultadoSync(s){return s.json()}}class x extends C{constructor(){super(decodeURIComponent(g("api"))),this.user="",this.pass="",this.mensaje="No se han proporcionado credenciales de acceso."}setUsuario(s){this.user=s}setPassword(s){this.pass=s}async login(){if(this.valida()!=!0)return!1;if(await this.post("login",{user:this.user,pass:this.pass}),this.resultado){if(this.resultado.success)return u("token",this.resultado.informacion.token),u("user",this.user),!0;this.mensaje="Credenciales incorrectas.",m(this.resultado.informacion)}else this.mensaje=`Ocurrio un problema al validar la informacion.
Intente nuevamente o contacte al administrador.`,m(this.error);return!1}valida(){return this.user===""&&this.pass===""?this.mensaje="No se han proporcionado credenciales de acceso.":this.user===""?this.mensaje="No se ha proporcionado el nombre de usuario.":this.pass===""?this.mensaje="No se ha proporcionado la contraseña.":!0}}class p extends o{constructor(s=null){return super("div",{clase:w}),this.txtTitulo="Mensaje de sistema",this.txtMensaje="",this.tipos={error:"msjError",exito:"msjExito",advertencia:"msjAdvertencia",informacion:"msjInformacion"},this.titulosDefault={msjError:"Error",msjExito:"Éxito",msjAdvertencia:"Advertencia",msjInformacion:"Información"},this.tipo=s??this.tipos.informacion,this.listo=!1,this.botones=[],this.inicia(),this}setMensaje(s){return this.txtMensaje=s,this}setTipo(s){return this.tipo=s,this.txtTitulo=this.titulosDefault[s],this}setTitulo(s){return this.txtTitulo=s,this}setBotones(s){return this.botones=s,this}inicia(){return this.marco=new o("div",{clase:"msjMarco"}),this.titulo=new o("span",{clase:"msjTitulo"}),this.cerrar=new o("span",{clase:"msjCerrar"}),this.mensaje=new o("span",{clase:"msjTexto"}),this}configura(){return this.marco.setClase(this.tipo),this.titulo.setTexto(this.txtTitulo),this.cerrar.setTexto("X"),this.cerrar.setListener("click",this.ocultar.bind(this)),this.mensaje.setTexto(this.txtMensaje),this}crea(){return this.marco.addHijos([this.titulo.getComponente(),this.cerrar.getComponente(),this.mensaje.getComponente()]),this.addHijo(this.marco.getComponente()),this}mostrar(){const s=this.configura().crea();document.querySelector("body").appendChild(s.getComponente())}ocultar(){this.removeComponente()}}class y{constructor(){this.elementos=[],this.listo=!1,this.mensaje=new p}msjError(s){this.msj(s,this.mensaje.tipos.error)}msjExito(s){this.msj(s,this.mensaje.tipos.exito)}msjAdvertencia(s){this.msj(s,this.mensaje.tipos.advertencia)}msjInformacion(s){this.msj(s,this.mensaje.tipos.informacion)}msj(s,t=s.tipos.informacion){new p().setTipo(t).setMensaje(s).mostrar()}}class T extends y{constructor(t){super();n(this,"login",async t=>{t.preventDefault(),this.modelo.setUsuario(this.formulario.usuario.getValor()),this.modelo.setPassword(this.formulario.password.getValor()),await this.modelo.login()?window.location.href="/":this.msjError(this.modelo.mensaje)});this.formulario=t,this.modelo=new x}}var r;class b extends o{constructor(){super("form",{clase:"formulario"});c(this,r,void 0);return l(this,r,new T(this)),this.inicia()}inicia(){return this.titulo=new o("label",{clase:"lblTitulo"}),this.usuario=new o("input",{clase:"inputLogin"}),this.password=new o("input",{clase:"inputLogin"}),this.btnLogin=new o("button",{clase:"btnLogin"}),this}configura(){return this.titulo.setTexto("Inicio de sesión"),this.usuario.setPropiedad("placeholder","Usuario"),this.password.setPropiedad("type","password"),this.password.setPropiedad("placeholder","Contraseña"),this.btnLogin.setTexto("Iniciar sesión"),this.setListener("submit",h(this,r).login),this}crea(){return this.addHijos([this.titulo.getComponente(),this.usuario.getComponente(),this.password.getComponente(),this.btnLogin.getComponente()]),this}mostrar(){return this.configura().crea().getComponente()}}r=new WeakMap;const S=()=>{d("token"),d("user"),document.querySelector(".login").appendChild(new b().mostrar())};S();
